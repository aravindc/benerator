<?xml version="1.0" encoding="iso-8859-1"?>
<setup 	xmlns="http://databene.org/benerator/0.5.8"
		xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		xsi:schemaLocation="http://databene.org/benerator/0.5.8 http://databene.org/benerator-0.5.8.xsd">

	<!-- define a database that will be referred by the id 'db' later -->
	<database id="db" url="jdbc:hsqldb:hsql://localhost" driver="org.hsqldb.jdbcDriver" user="sa" />

	<execute target="db" onError="ignore">
		DROP TABLE db_user;
		DROP TABLE db_role;
	</execute> 

	<execute target="db">
		CREATE TABLE db_role (
		  id   int         generated by default as identity (start with 1) NOT NULL,
		  name varchar(16) NOT NULL,
		  PRIMARY KEY (id)
		);

		CREATE TABLE db_user (
		  id       int         generated by default as identity (start with 1) NOT NULL,
		  name     varchar(30) NOT NULL,
		  email    varchar(30) NOT NULL,
		  password varchar(16) NOT NULL,
		  role_fk  int NOT NULL,
		  active   smallint    default 1 NOT NULL,
		  PRIMARY KEY  (id),
		  CONSTRAINT user_role_fk FOREIGN KEY (role_fk) REFERENCES db_role (id),
		  constraint active_flag check (active in (0,1))
		);
		CREATE INDEX user_role_fki on db_user (role_fk);
	</execute> 

	<create-entities name="db_role" count="10" consumer="db" />
	<create-entities name="db_user" count="10000" consumer="db" pagesize="1000">
  		<reference name="role_fk" source="db" targetType="db_role" distribution="random"/>
	</create-entities>
</setup>